    <!DOCTYPE html> 
    <html lang="eng">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />
        <link rel="stylesheet" href="hello.css">
        
    </head>
    <body>
        <header class="header">
            <h2 class="title">Hello , USER</h2>
            <h4 class="subtitle">
            
                how can <I></I> help you today?
            </h4>

            <ul class="suggestion-list">
            
            <li class="suggestion">
                <h4 class="text">help me plan a trip under $2000</h4>
                <span class="icon material-symbols-rounded">draw</span>
        
            <li class="suggestion">
                <h4 class="text">what are the best tips to improve my public speaking skils </h4>
                <span class="icon material-symbols-rounded">lightbulb</span>
            </li>
            <li class="suggestion">
                <h4 class="text">Can you help me find the latest news web development</h4>
                <span class="icon material-symbols-rounded">explore</span>
            </li>
            <li class="suggestion">
                <h4 class="text">write javascript code to sum all elements in an array</h4>
                <span class="icon material-symbols-rounded">code</span>
            </li>
        </ul>

    </header>

    <!-- Chatlist -->

    <div class="chat-list"></div>
    </div>

        <div class="typing-area">
            <form action="#" class="typing-form">
                <div class="input-wrapper">
                    <input type="text" placeholder="Enter a prompt here " class="typing-input" required>
                    <button class="icon material-symbols-rounded">send</button>
                </div>
                <div class="action-button">
                    <span id="toggle-theme-button" class="icon material-symbols-rounded">light_mode</span>
                    <span id="delete-chat-button" class="icon material-symbols-rounded">delete</span>
                </div>
            </form>
            <p class="disclaimer-text">
                ChatBot may display inaccurate info,including about people,so double-check it's response

            </p>
            </div>
        
    </body>
    <script>
        const typingForm = document.querySelector(".typing-form");
    const chatList = document.querySelector(".chat-list");
    const suggestions = document.querySelectorAll(".suggestion-list .suggestion");
    const toggleThemeButton = document.querySelector("#toggle-theme-button");
    const deleteChatButton = document.querySelector("#delete-chat-button");

    let userMessage = null;
    const API_KEY = "AIzaSyCsZ-k753Z6WtOUwamhxTpzklKKH9T6G9U"; // Example key (replace with valid one)
    const API_URL = `https://generativelanguage.googleapis.com/v1/models/gemini-pro:generateContent?key=${API_KEY}`;

    const loadLocalstorageData = () => {
        const savedChats = localStorage.getItem("savedChats");
        const isLightMode = (localStorage.getItem("themeColor") === "light_mode");

        document.body.classList.toggle("light_mode", isLightMode);
        toggleThemeButton.innerText = isLightMode ? "dark_mode" : "light_mode";

        chatList.innerHTML = savedChats || "";


        document.body.classList.toggle("hide-header",savedChats);
        scrollToBottom();  // Added function to scroll to the bottom after loading
    }

    const scrollToBottom = () => {
        const lastMessage = chatList.lastElementChild;
        if (lastMessage) {
            lastMessage.scrollIntoView({ behavior: 'smooth' });
        }
    }

    loadLocalstorageData();

    const createMessageElement = (content, ...classes) => {
        const div = document.createElement("div");
        div.classList.add("message", ...classes);
        div.innerHTML = content;
        return div;
    }

    const showTypingEffect = (text, textElement, incomingMessageDiv) => {
        const words = text.split(' ');  
        let currentWordIndex = 0;
        const typingInterval = setInterval(() => {
            textElement.innerText += (currentWordIndex === 0 ? '' : ' ') + words[currentWordIndex++];
            incomingMessageDiv.querySelector(".icon").classList.add("hide");

            if (currentWordIndex === words.length) {
                clearInterval(typingInterval);

                incomingMessageDiv.querySelector(".icon").classList.remove("hide");
                localStorage.setItem("savedChats", chatList.innerHTML);
                scrollToBottom();  // Added smooth scrolling when typing finishes
            }
        }, 75);
    }

    const generateAPIResponse = async (incomingMessageDiv) => {
        const textElement = incomingMessageDiv.querySelector(".text");
        try {
            const response = await fetch(API_URL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    contents: [{
                        role: "user",
                        parts: [{ text: userMessage }]
                    }]
                })
            });

            const data = await response.json();
            const apiResponse = data.candidates[0].content.parts[0].text.replace(/\*\*(.*?)\*\*/g, '$1');
            
            showTypingEffect(apiResponse, textElement, incomingMessageDiv);
        } catch (error) {
            console.log(error);
        } finally {
            incomingMessageDiv.classList.remove("loading");
        }
    }

    const showLoadingAnimation = () => {
        const html = `<div class="message-content">
            <img src="gemini.svg" alt="" class="avatar">
            <p class="text"></p>
            <div class="loading-indicator">
                <div class="loading-bar"></div>
                <div class="loading-bar"></div>
                <div class="loading-bar"></div>
            </div>
        </div>
        <span onclick="copyMessage(this)" class="icon material-symbols-rounded">content_copy</span>`;
        const incomingMessageDiv = createMessageElement(html, "incoming", "loading");
        chatList.appendChild(incomingMessageDiv);

        scrollToBottom();  // Added smooth scrolling when new message is added
        generateAPIResponse(incomingMessageDiv);
    }

    const copyMessage = (copyIcon) => {
        const messageText = copyIcon.parentElement.querySelector(".text").innerText;
        navigator.clipboard.writeText(messageText); 
        copyIcon.innerText = "done";
        setTimeout(() => copyIcon.innerText = "content_copy", 1000);
    }

    const handleOutgoingChat = () => {
        userMessage = typingForm.querySelector(".typing-input").value.trim() || userMessage;
        if (!userMessage) return;

        const html = `<div class="message-content">
            <img src="user.jpg" alt="UserImage" class="avatar">
            <p class="text"></p>
        </div>`;

        const outgoingMessageDiv = createMessageElement(html, "outgoing");
        outgoingMessageDiv.querySelector(".text").innerText = userMessage;
        chatList.appendChild(outgoingMessageDiv);
        typingForm.reset();
        scrollToBottom(); // Added smooth scrolling for outgoing messages
        document.body.classList.add("hide-header");
        setTimeout(showLoadingAnimation, 500);
    }


    suggestions.forEach( suggestion => {
        suggestion.addEventListener("click",()=>{
        userMessage =suggestion.querySelector(".text").innerText;
        handleOutgoingChat();
        });
    }
    );

    toggleThemeButton.addEventListener("click", () => {
        const isLightMode = document.body.classList.toggle("light_mode");
        localStorage.setItem("themeColor", isLightMode ? "light_mode" : "dark_mode");
        toggleThemeButton.innerText = isLightMode ? "dark_mode" : "light_mode";
    })
    deleteChatButton.addEventListener("click",() =>{
        if(confirm("Are you want to delete your messages?")){
            localStorage.removeItem("savedChats");
            loadLocalstorageData();
        }
    })


    typingForm.addEventListener("submit", (e) => {
        e.preventDefault();
        handleOutgoingChat();
    });

    </script>

    <style>
        

    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap');
    *{
        font-family: 
        "Poppins", sans-serif;
        margin: 0;
        padding: 0;
        box-sizing: border-box;

    }

    :root{
        --text-color:#E3E3E3;
        --subheading-color:#828282;
        --primary-color:#242424;
        --secondary-color:#383838;
        --secondary-hover-color:#444;
        --placeholder-color:#A6A6A6;
    }

    .light_mode{
        --text-color:#222;
        --subheading-color:#A0A0A0;
        --primary-color:#FFF;
        --secondary-color:#E9EEF6;
        --secondary-hover-color:#DBE1EA;
        --placeholder-color:#6C6C6C;
    }

    body{
        background: var(--primary-color);
    }

    .header, .typing-area{
        color: var(--text-color);
    }
    .header, .chat-list .message,.typing-form{
    max-width:1000px;
    margin: 0 auto;

    }


    .header{
        margin-top: 7vh;
        padding: 1rem;
        
    }

    body.hide-header .header{
        display: none;
        margin-top: 0;
    }


    .header :where(.title ,.subtitle){
    font-weight: 500;
    line-height: 3.6rem;

    }

    .header .title{
        font-size: 2.7rem;
        background-clip: text;
        background: linear-gradient(to right, #4285f4,#d96570);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        width: fit-content;
    }

    .header .subtitle{
        font-size: 2.4rem;
        color: var(--subheading-color);
    }
    .suggestion-list{
    margin-top: 9.5vh;
    list-style: none;
    display: flex;
    gap: 1.2rem;
    overflow-x: auto;
    scrollbar-width: none;


    }

    .suggestion-list .suggestion{
    padding: 1.2rem;
    cursor: pointer;
    width: 227px;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    justify-content: space-between;
    border-radius: 0.7rem;

    background: var(--secondary-color);
    }

    .suggestion-list .suggestion:hover{
    background: var(--secondary-hover-color);

    }

    .suggestion-list .suggestion .text{
    font-weight: 400;
    }
    .suggestion-list .suggestion .icon{
    background: var(--primary-color);
    height: 42px;
    width: 42px;
    font: size 1.3rem;
    margin-top: 2.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;

    }
    .typing-area{
    position: fixed;
    width: 100%;
    bottom: 0;
    padding:1rem;
    background: var(--primary-color);
    }
    .chat-list  { 
    padding: 2rem 1rem 12rem ;
    max-width: 100vh;
    overflow-y: auto;
    scrollbar-color: #999 transparent;

    }

    .chat-list .message.incoming {
    margin-top: 1.5rem;

    }
    .chat-list .message .message-content{
    display: flex;
    align-items: center;
    gap: 1.5rem;
    width: 100%;
    }
    .chat-list .message .avatar {
    width: 40px;
    height: 40px;
    object-fit: cover;
    border-radius: 50%;
    align-self: flex-start;
    }
    .chat-list .message .text {
    color: var(--text-color);
    }

    .chat-list .message.loading .avatar{
        animation: rotate 3s linear infinite;
    }


    @keyframes rotate {
        100%{
            transform: rotate(360deg);
        }
    }

    .chat-list .message.loading .text{
        display: none;
    }



    .chat-list .message .icon {
    height: 35px;
    width: 35px;
    display: flex;
    cursor: pointer;
    font-size: 1.25rem;
    margin-left: 3.5rem;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    background: var(--secondary-color);
    color: var(--text-color);
    visibility: hidden;
    }
    .chat-list .message:not(.loading):hover .icon:not(.hide) {
    visibility: visible;
    }


    .chat-list .message .icon:hover{
    background: var(--secondary-color);
    }
    .chat-list .loading-indicator{
    display: none;
    width: 100%;
    gap: 0.8rem;
    flex-direction: column;
    }
    .chat-list .message.loading .loading-indicator{
        display: flex;
    }

    .chat-list .loading-indicator .loading-bar{
    height: 11px;
    width: 100%;
    border-radius: 0.14rem;
    background: linear-gradient(to right,#4285f4,var(--primary-color)) #4285f4;
    animation: animate 3s linear infinite;
    }

    .chat-list .loading-indicator .loading-bar
    :last-child{
        width: 70%;

    }
    @keyframes animate {
        0% {
            background-position: -800px 0;
        }

        100% {
            background-position: 800px 0;
        }
    }


    .typing-area :where(.typing-form, .action-button) {
    display: flex;
    gap:0.75rem;

    }

    .typing-area .typing-input{
    width: 100%;
    height: 100%;
    border:none;
    outline: none;
    font-size: 1rem;
    color: var(--text-color);
    border-radius: 6.2rem;
    padding: 1.1rem 4rem 1.1rem 1.5rem;

    background: var(--secondary-color);

    }
    .typing-area .typing-input:focus{
    background: var(--secondary-hover-color);

    }
    .typing-area .typing-input::placeholder {
    color: var(--placeholder-color);

    }
    .typing-area .input-wrapper{
    height: 56px;
    width: 100%;
    display: flex;
    position: relative;
    }
    .typing-area .icon{
    height: 56px;
    width: 56px;
    background: var(--secondary-color);
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    cursor: pointer;

    }
    .typing-area .input-wrapper .icon{
    position: absolute;
    right: 0;
    outline:none;
    border: none;
    background: none;
    color: var(--text-color);
    transform: scale(0);
    transform: transform 0.2s ease;
    }

    .typing-area .input-wrapper .typing-input:valid ~ .icon{
    transform: scale(1);
    }


    .typing-area .icon:hover{
    background: var(--secondary-hover-color)!important;
    }
    .typing-area .disclaimer-text{
    font-size: 0.8rem;
    margin-top: 1rem;
    text-align: center;
    color: var(--placeholder-color);

    }   
    </style>
    </html>